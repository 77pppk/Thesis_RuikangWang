


obj = log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)*(1+2/(1-0.5*erfc(((P_noise_s*kappa-(d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))/(2*sqrt((P_noise_s*d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))))/sqrt(2))))

obj_diff = -d/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c))^2*(1+2/(1-0.5*erfc(((P_noise_s*kappa-(d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))/(2*sqrt((P_noise_s*d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))))/sqrt(2))))*([(log(2)*Hc(1)*conj(Hc(1)))/(P_noise_c*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)), (log(2)*(Hc(1)*conj(Hc(2)) + Hc(2)*conj(Hc(1))))/(P_noise_c*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)), (log(2)*(Hc(1)*conj(Hc(2))*1i - Hc(2)*conj(Hc(1))*1i))/(P_noise_c*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)), (log(2)*Hc(2)*conj(Hc(2)))/(P_noise_c*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))])  +...
        d/log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)*(1+2*(-1/sqrt(2*pi)*exp(-((P_noise_s*kappa-(d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))/(2*sqrt((P_noise_s*d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))))^2/2))*([- ((d*(Hs(1,1)*conj(Hs(1,1)) + Hs(2,1)*conj(Hs(2,1)) + Hs(3,1)*conj(Hs(3,1)) + Hs(4,1)*conj(Hs(4,1))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (d*Hc(1)*conj(Hc(1))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))/(2*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(1/2)) - ((P_noise_s*kappa - (d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))*((P_noise_s*d*(Hs(1,1)*conj(Hs(1,1)) + Hs(2,1)*conj(Hs(2,1)) + Hs(3,1)*conj(Hs(3,1)) + Hs(4,1)*conj(Hs(4,1))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (P_noise_s*d*Hc(1)*conj(Hc(1))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))))/(4*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(3/2)), - ((d*(Hs(1,1)*conj(Hs(1,2)) + Hs(1,2)*conj(Hs(1,1)) + Hs(2,1)*conj(Hs(2,2)) + Hs(2,2)*conj(Hs(2,1)) + Hs(3,1)*conj(Hs(3,2)) + Hs(3,2)*conj(Hs(3,1)) + Hs(4,1)*conj(Hs(4,2)) + Hs(4,2)*conj(Hs(4,1))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (d*(Hc(1)*conj(Hc(2)) + Hc(2)*conj(Hc(1)))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))/(2*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(1/2)) - (((P_noise_s*d*(Hs(1,1)*conj(Hs(1,2)) + Hs(1,2)*conj(Hs(1,1)) + Hs(2,1)*conj(Hs(2,2)) + Hs(2,2)*conj(Hs(2,1)) + Hs(3,1)*conj(Hs(3,2)) + Hs(3,2)*conj(Hs(3,1)) + Hs(4,1)*conj(Hs(4,2)) + Hs(4,2)*conj(Hs(4,1))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (P_noise_s*d*(Hc(1)*conj(Hc(2)) + Hc(2)*conj(Hc(1)))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))*(P_noise_s*kappa - (d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))))/(4*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(3/2)), - ((d*(Hs(1,1)*conj(Hs(1,2))*1i - Hs(1,2)*conj(Hs(1,1))*1i + Hs(2,1)*conj(Hs(2,2))*1i - Hs(2,2)*conj(Hs(2,1))*1i + Hs(3,1)*conj(Hs(3,2))*1i - Hs(3,2)*conj(Hs(3,1))*1i + Hs(4,1)*conj(Hs(4,2))*1i - Hs(4,2)*conj(Hs(4,1))*1i))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (d*(Hc(1)*conj(Hc(2))*1i - Hc(2)*conj(Hc(1))*1i)*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))/(2*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(1/2)) - (((P_noise_s*d*(Hs(1,1)*conj(Hs(1,2))*1i - Hs(1,2)*conj(Hs(1,1))*1i + Hs(2,1)*conj(Hs(2,2))*1i - Hs(2,2)*conj(Hs(2,1))*1i + Hs(3,1)*conj(Hs(3,2))*1i - Hs(3,2)*conj(Hs(3,1))*1i + Hs(4,1)*conj(Hs(4,2))*1i - Hs(4,2)*conj(Hs(4,1))*1i))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (P_noise_s*d*(Hc(1)*conj(Hc(2))*1i - Hc(2)*conj(Hc(1))*1i)*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))*(P_noise_s*kappa - (d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))))/(4*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(3/2)), - ((d*(Hs(1,2)*conj(Hs(1,2)) + Hs(2,2)*conj(Hs(2,2)) + Hs(3,2)*conj(Hs(3,2)) + Hs(4,2)*conj(Hs(4,2))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (d*Hc(2)*conj(Hc(2))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))/(2*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(1/2)) - ((P_noise_s*kappa - (d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))*((P_noise_s*d*(Hs(1,2)*conj(Hs(1,2)) + Hs(2,2)*conj(Hs(2,2)) + Hs(3,2)*conj(Hs(3,2)) + Hs(4,2)*conj(Hs(4,2))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (P_noise_s*d*Hc(2)*conj(Hc(2))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))))/(4*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(3/2))]) /(1-0.5*erfc(((P_noise_s*kappa-(d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))/(2*sqrt((P_noise_s*d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))))/sqrt(2)))^2)




% qfunc(x) = 0.5*erfc(x/sqrt(2))

% g = (P_noise_s*kappa-(d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))/(2*sqrt((P_noise_s*d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c))))
% Q(g) = 0.5*erfc(((P_noise_s*kappa-(d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))/(2*sqrt((P_noise_s*d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))))/sqrt(2))
% f = log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)
% df = [(log(2)*Hc(1)*conj(Hc(1)))/(P_noise_c*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)), (log(2)*(Hc(1)*conj(Hc(2)) + Hc(2)*conj(Hc(1))))/(P_noise_c*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)), (log(2)*(Hc(1)*conj(Hc(2))*1i - Hc(2)*conj(Hc(1))*1i))/(P_noise_c*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)), (log(2)*Hc(2)*conj(Hc(2)))/(P_noise_c*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))]
% 
% dg = [- ((d*(Hs(1,1)*conj(Hs(1,1)) + Hs(2,1)*conj(Hs(2,1)) + Hs(3,1)*conj(Hs(3,1)) + Hs(4,1)*conj(Hs(4,1))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (d*Hc(1)*conj(Hc(1))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))/(2*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(1/2)) - ((P_noise_s*kappa - (d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))*((P_noise_s*d*(Hs(1,1)*conj(Hs(1,1)) + Hs(2,1)*conj(Hs(2,1)) + Hs(3,1)*conj(Hs(3,1)) + Hs(4,1)*conj(Hs(4,1))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (P_noise_s*d*Hc(1)*conj(Hc(1))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))))/(4*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(3/2)), - ((d*(Hs(1,1)*conj(Hs(1,2)) + Hs(1,2)*conj(Hs(1,1)) + Hs(2,1)*conj(Hs(2,2)) + Hs(2,2)*conj(Hs(2,1)) + Hs(3,1)*conj(Hs(3,2)) + Hs(3,2)*conj(Hs(3,1)) + Hs(4,1)*conj(Hs(4,2)) + Hs(4,2)*conj(Hs(4,1))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (d*(Hc(1)*conj(Hc(2)) + Hc(2)*conj(Hc(1)))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))/(2*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(1/2)) - (((P_noise_s*d*(Hs(1,1)*conj(Hs(1,2)) + Hs(1,2)*conj(Hs(1,1)) + Hs(2,1)*conj(Hs(2,2)) + Hs(2,2)*conj(Hs(2,1)) + Hs(3,1)*conj(Hs(3,2)) + Hs(3,2)*conj(Hs(3,1)) + Hs(4,1)*conj(Hs(4,2)) + Hs(4,2)*conj(Hs(4,1))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (P_noise_s*d*(Hc(1)*conj(Hc(2)) + Hc(2)*conj(Hc(1)))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))*(P_noise_s*kappa - (d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))))/(4*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(3/2)), - ((d*(Hs(1,1)*conj(Hs(1,2))*1i - Hs(1,2)*conj(Hs(1,1))*1i + Hs(2,1)*conj(Hs(2,2))*1i - Hs(2,2)*conj(Hs(2,1))*1i + Hs(3,1)*conj(Hs(3,2))*1i - Hs(3,2)*conj(Hs(3,1))*1i + Hs(4,1)*conj(Hs(4,2))*1i - Hs(4,2)*conj(Hs(4,1))*1i))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (d*(Hc(1)*conj(Hc(2))*1i - Hc(2)*conj(Hc(1))*1i)*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))/(2*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(1/2)) - (((P_noise_s*d*(Hs(1,1)*conj(Hs(1,2))*1i - Hs(1,2)*conj(Hs(1,1))*1i + Hs(2,1)*conj(Hs(2,2))*1i - Hs(2,2)*conj(Hs(2,1))*1i + Hs(3,1)*conj(Hs(3,2))*1i - Hs(3,2)*conj(Hs(3,1))*1i + Hs(4,1)*conj(Hs(4,2))*1i - Hs(4,2)*conj(Hs(4,1))*1i))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (P_noise_s*d*(Hc(1)*conj(Hc(2))*1i - Hc(2)*conj(Hc(1))*1i)*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))*(P_noise_s*kappa - (d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))))/(4*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(3/2)), - ((d*(Hs(1,2)*conj(Hs(1,2)) + Hs(2,2)*conj(Hs(2,2)) + Hs(3,2)*conj(Hs(3,2)) + Hs(4,2)*conj(Hs(4,2))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (d*Hc(2)*conj(Hc(2))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))/(2*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(1/2)) - ((P_noise_s*kappa - (d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))*((P_noise_s*d*(Hs(1,2)*conj(Hs(1,2)) + Hs(2,2)*conj(Hs(2,2)) + Hs(3,2)*conj(Hs(3,2)) + Hs(4,2)*conj(Hs(4,2))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (P_noise_s*d*Hc(2)*conj(Hc(2))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))))/(4*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(3/2))]
% 
% obj = log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)*(1+2/(1-0.5*erfc(((P_noise_s*kappa-(d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))/(2*sqrt((P_noise_s*d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))))/sqrt(2))))
% 
% obj_diff = -d/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c))^2*(1+2/(1-0.5*erfc(((P_noise_s*kappa-(d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))/(2*sqrt((P_noise_s*d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))))/sqrt(2))))*([(log(2)*Hc(1)*conj(Hc(1)))/(P_noise_c*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)), (log(2)*(Hc(1)*conj(Hc(2)) + Hc(2)*conj(Hc(1))))/(P_noise_c*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)), (log(2)*(Hc(1)*conj(Hc(2))*1i - Hc(2)*conj(Hc(1))*1i))/(P_noise_c*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)), (log(2)*Hc(2)*conj(Hc(2)))/(P_noise_c*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))])  +...
%     d/log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)*(1+2*(-1/sqrt(2*pi)*exp(-((P_noise_s*kappa-(d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))/(2*sqrt((P_noise_s*d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))))^2/2))*([- ((d*(Hs(1,1)*conj(Hs(1,1)) + Hs(2,1)*conj(Hs(2,1)) + Hs(3,1)*conj(Hs(3,1)) + Hs(4,1)*conj(Hs(4,1))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (d*Hc(1)*conj(Hc(1))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))/(2*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(1/2)) - ((P_noise_s*kappa - (d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))*((P_noise_s*d*(Hs(1,1)*conj(Hs(1,1)) + Hs(2,1)*conj(Hs(2,1)) + Hs(3,1)*conj(Hs(3,1)) + Hs(4,1)*conj(Hs(4,1))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (P_noise_s*d*Hc(1)*conj(Hc(1))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))))/(4*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(3/2)), - ((d*(Hs(1,1)*conj(Hs(1,2)) + Hs(1,2)*conj(Hs(1,1)) + Hs(2,1)*conj(Hs(2,2)) + Hs(2,2)*conj(Hs(2,1)) + Hs(3,1)*conj(Hs(3,2)) + Hs(3,2)*conj(Hs(3,1)) + Hs(4,1)*conj(Hs(4,2)) + Hs(4,2)*conj(Hs(4,1))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (d*(Hc(1)*conj(Hc(2)) + Hc(2)*conj(Hc(1)))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))/(2*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(1/2)) - (((P_noise_s*d*(Hs(1,1)*conj(Hs(1,2)) + Hs(1,2)*conj(Hs(1,1)) + Hs(2,1)*conj(Hs(2,2)) + Hs(2,2)*conj(Hs(2,1)) + Hs(3,1)*conj(Hs(3,2)) + Hs(3,2)*conj(Hs(3,1)) + Hs(4,1)*conj(Hs(4,2)) + Hs(4,2)*conj(Hs(4,1))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (P_noise_s*d*(Hc(1)*conj(Hc(2)) + Hc(2)*conj(Hc(1)))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))*(P_noise_s*kappa - (d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))))/(4*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(3/2)), - ((d*(Hs(1,1)*conj(Hs(1,2))*1i - Hs(1,2)*conj(Hs(1,1))*1i + Hs(2,1)*conj(Hs(2,2))*1i - Hs(2,2)*conj(Hs(2,1))*1i + Hs(3,1)*conj(Hs(3,2))*1i - Hs(3,2)*conj(Hs(3,1))*1i + Hs(4,1)*conj(Hs(4,2))*1i - Hs(4,2)*conj(Hs(4,1))*1i))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (d*(Hc(1)*conj(Hc(2))*1i - Hc(2)*conj(Hc(1))*1i)*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))/(2*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(1/2)) - (((P_noise_s*d*(Hs(1,1)*conj(Hs(1,2))*1i - Hs(1,2)*conj(Hs(1,1))*1i + Hs(2,1)*conj(Hs(2,2))*1i - Hs(2,2)*conj(Hs(2,1))*1i + Hs(3,1)*conj(Hs(3,2))*1i - Hs(3,2)*conj(Hs(3,1))*1i + Hs(4,1)*conj(Hs(4,2))*1i - Hs(4,2)*conj(Hs(4,1))*1i))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (P_noise_s*d*(Hc(1)*conj(Hc(2))*1i - Hc(2)*conj(Hc(1))*1i)*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))*(P_noise_s*kappa - (d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))))/(4*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(3/2)), - ((d*(Hs(1,2)*conj(Hs(1,2)) + Hs(2,2)*conj(Hs(2,2)) + Hs(3,2)*conj(Hs(3,2)) + Hs(4,2)*conj(Hs(4,2))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (d*Hc(2)*conj(Hc(2))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))/(2*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(1/2)) - ((P_noise_s*kappa - (d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))*((P_noise_s*d*(Hs(1,2)*conj(Hs(1,2)) + Hs(2,2)*conj(Hs(2,2)) + Hs(3,2)*conj(Hs(3,2)) + Hs(4,2)*conj(Hs(4,2))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)) - (P_noise_s*d*Hc(2)*conj(Hc(2))*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(P_noise_c*log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)^2*((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1))))/(4*((P_noise_s*d*(conj(Hs(1,1))*(Hs(1,1)*q(1) + Hs(1,2)*(q(2) - q(3)*1i)) + conj(Hs(1,2))*(Hs(1,2)*q(4) + Hs(1,1)*(q(2) + q(3)*1i)) + conj(Hs(2,1))*(Hs(2,1)*q(1) + Hs(2,2)*(q(2) - q(3)*1i)) + conj(Hs(2,2))*(Hs(2,2)*q(4) + Hs(2,1)*(q(2) + q(3)*1i)) + conj(Hs(3,1))*(Hs(3,1)*q(1) + Hs(3,2)*(q(2) - q(3)*1i)) + conj(Hs(3,2))*(Hs(3,2)*q(4) + Hs(3,1)*(q(2) + q(3)*1i)) + conj(Hs(4,1))*(Hs(4,1)*q(1) + Hs(4,2)*(q(2) - q(3)*1i)) + conj(Hs(4,2))*(Hs(4,2)*q(4) + Hs(4,1)*(q(2) + q(3)*1i))))/(log2((conj(Hc(1))*(Hc(1)*q(1) + Hc(2)*(q(2) - q(3)*1i)) + conj(Hc(2))*(Hc(2)*q(4) + Hc(1)*(q(2) + q(3)*1i)))/P_noise_c + 1)))^(3/2))]) /(1-0.5*erfc(((P_noise_s*kappa-(d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))/(2*sqrt((P_noise_s*d*trace(Hs*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hs'))/(log2(1 + Hc*[q(1) q(2)+1j*q(3); q(2)-1j*q(3) q(4)]*Hc'/P_noise_c)))))/sqrt(2)))^2)
